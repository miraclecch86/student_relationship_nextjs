# 제품 요구사항 문서(PRD): 예시 학급 데이터 생성

## 1. 개요 (Overview)

본 문서는 Next.js 기반 학생 관계 분석 애플리케이션의 테스트 및 데모를 위한 예시 학급 데이터를 생성하는 요구사항을 정의합니다. 생성될 데이터는 현실적인 학급의 역동성과 학생 간 관계 변화를 모사하여, 애플리케이션의 다양한 기능을 효과적으로 시연하고 테스트하는 것을 목표로 합니다.

**본 PRD는 `EXAMPLE_CLASS_DATA_DRAFT.md`와 함께 통합된 시스템으로 작동합니다:**
- 본 PRD: 데이터 생성의 규칙과 로직 정의
- Draft 파일: 구체적인 스토리 예시와 데이터 방향 제시
- Node.js 스크립트: 위 두 문서를 기반으로 실제 데이터 동적 생성

## 2. 목표 (Goals)

- 애플리케이션의 핵심 기능(학생 관리, 설문 관리, 관계 분석, 주관식 답변 분석 등)을 시연할 수 있는 충분한 양과 질의 데이터를 확보한다.
- 시간 경과(월별)에 따른 학생 간 관계 변화 및 개별 학생의 심리 변화를 나타내는 데이터를 생성하여, 애플리케이션의 분석 기능의 깊이를 보여준다.
- 개발 및 테스트 과정에서 실제 데이터를 사용하기 어려운 상황을 대체할 수 있는 현실감 있는 가상 데이터를 제공한다.
- 데모용 데이터로써 실제 교육 현장에서 발생할 수 있는 다양한 상황과 관계 패턴을 포함한다.
- **신규 사용자들에게 애플리케이션의 기능과 가치를 쉽게 이해할 수 있는 공개 예시 학급을 제공한다.**

## 2.1 공개 데모 학급 목표 (Public Demo Class Goals)

### 2.1.1 접근성 및 사용자 경험
- **전체 공개**: 모든 사용자가 별도 권한 없이 예시 학급 데이터에 접근 가능
- **즉시 체험**: 회원가입 후 바로 애플리케이션의 모든 기능을 체험할 수 있는 환경 제공
- **학습 도구**: 새로운 사용자가 시스템 사용법을 익힐 수 있는 튜토리얼 역할
- **기능 시연**: 관계 분석, 시각화, 설문 결과 등 모든 핵심 기능의 실제 작동 예시

### 2.1.2 데이터 보호 및 관리
- **읽기 전용**: 모든 사용자는 예시 학급을 볼 수 있지만 수정/삭제는 불가
- **데이터 무결성**: 공개 데모 데이터는 시스템에 의해 보호되어 항상 일관된 상태 유지
- **리셋 기능**: 필요시 관리자가 데모 데이터를 초기 상태로 복원 가능

## 3. 데이터 생성 철학 및 접근법

### 3.1 일관성 유지 원칙
- **성격 기반 생성**: 각 학생의 성격 특성은 모든 답변과 관계 설정의 기초가 됩니다.
- **스토리 연속성**: 월별 스토리는 연속성을 갖고 발전하며, 이전 달의 사건이 다음 달에 영향을 줍니다.
- **현실적 관계 변화**: 급격한 관계 변화보다는 점진적이고 자연스러운 변화를 추구합니다.

### 3.2 다양성 확보 전략
- **균형잡힌 관계 분포**: 모든 학생이 친한 친구만 있지 않고, 다양한 관계 유형을 갖도록 합니다.
- **갈등과 화해**: 학급 내 자연스러운 갈등과 해결 과정을 포함합니다.
- **개별성 존중**: 각 학생의 고유한 특성과 성장 스토리를 반영합니다.

## 4. 상세 요구사항 (Detailed Requirements)

### 4.1 학급 (Class)
- **생성 학급 수**: 1개
- **학급 이름**: "샘솔 초등학교 3학년 1반"
- **학급 특성**: 일반적인 초등학교 3학년 학급의 특성을 반영
- **🔑 공개 설정**: 
  - `is_demo: true` - 데모 학급임을 표시
  - `is_public: true` - 모든 사용자 접근 가능
  - 또는 시스템 전용 데모 계정 소유로 설정

### 4.2 학생 (Students)
- **총 학생 수**: 40명
- **성별 비율**: 남학생 20명, 여학생 20명 (1:1 비율)
- **이름 생성**: 한국어 이름으로 중복되지 않도록 생성 (`EXAMPLE_CLASS_DATA_DRAFT.md` 참조)
- **성격 특성 시스템**:
  - 각 학생마다 2-3개의 성격 키워드 부여
  - 성격 특성은 데이터베이스가 아닌 스크립트 로직 내에서만 관리
  - 모든 관계 설정과 답변 생성의 기초 자료로 활용

### 4.3 설문지 (Surveys)
- **생성 설문지 수**: 9개 (4월~12월)
- **월별 설문 이름**: "4월 관계 설문", "5월 관계 설문", ... "12월 관계 설문"
- **설문 설명**: 각 월의 주요 이벤트나 특성을 간단히 기술

### 4.4 주관식 질문 (Open-ended Questions)
각 설문지에 동일하게 포함될 5개 질문:
1. **반에서 좋은 친구는?**
   - 답변 형식: 학생 이름 나열 또는 '없음'
   - 실제 관계 데이터와 일치해야 함
2. **좋은 친구가 좋은 이유는?**
   - 답변 형식: 초등학생 수준의 자유 서술
   - 성격 특성과 월별 스토리 반영
3. **반에서 불편한 친구는?**
   - 답변 형식: 학생 이름 나열 또는 '없음'
   - 실제 관계 데이터와 일치해야 함
4. **불편한 친구가 불편한 이유는?**
   - 답변 형식: 초등학생 수준의 자유 서술
   - 구체적 갈등 상황 반영 (Draft 파일 스토리 활용)
5. **선생님에 대한 학생의 생각은?**
   - 답변 형식: 긍정적/중립적/부정적 뉘앙스 포함
   - 학생의 성격과 학교 적응도 반영

### 4.5 관계 유형 정의
- **"매우 친함"**: 가장 친한 친구, 비밀도 나누는 사이
- **"친함"**: 자주 어울리고 즐겁게 지내는 친구
- **"보통"**: 특별한 감정 없이 그냥 반 친구
- **"약간 불편함"**: 사소한 갈등이나 성격 차이로 불편함
- **"매우 불편함"**: 명확한 갈등이나 심각한 트러블
- **"잘 모름"**: 상호작용이 거의 없어서 판단하기 어려움

### 4.6 월별 스토리라인 및 관계 진화 규칙

#### 4월: 새로운 시작과 탐색
- **관계 분포**: 대부분 "보통" 또는 "잘 모름"
- **친함 관계**: 전체의 10-15% 정도 (활발한 학생 중심)
- **불편함**: 5% 미만 (첫인상 기반의 미미한 불편함)
- **주요 테마**: 낯가림, 탐색, 첫인상 형성

#### 5월-8월: 관계 심화 및 변화
- **이벤트 기반 관계 변화**: Draft 파일의 스토리 참조
- **친함 관계 증가**: 점진적으로 15-25%까지 증가
- **갈등 발생**: 소수의 명확한 갈등 상황 생성
- **그룹 형성**: 3-5명 단위의 친구 그룹 형성

#### 9월-12월: 관계 안정 및 재편
- **관계 안정화**: 급격한 변화보다는 미세 조정
- **갈등 해결**: 일부 갈등의 자연스러운 해결 과정
- **새로운 발견**: 숨겨진 재능이나 성격의 새로운 면 발견
- **연말 분위기**: 전반적으로 따뜻하고 긍정적인 분위기

### 4.7 답변 생성 상세 규칙

#### 언어 수준 및 특성
- **연령 적합성**: 초등학교 3학년 수준의 어휘와 표현
- **개성 반영**: 학생별 성격에 따른 말투와 표현 방식 차이
- **감정 표현**: 솔직하고 직접적인 감정 표현

#### 답변 길이 및 구체성
- **좋은/불편한 이유**: 1-2문장의 구체적 설명
- **선생님에 대한 생각**: 1-2문장의 솔직한 의견
- **일관성 유지**: 같은 학생의 성격과 이전 답변과의 연속성

#### 현실성 확보
- **모든 질문에 답변하지 않을 수 있음**: 일부 학생은 특정 질문에 답변하지 않거나 "잘 모르겠어요" 응답
- **관계의 비대칭성**: A가 B를 좋아해도 B가 A를 좋아하지 않을 수 있음
- **시간에 따른 변화**: 답변 내용과 어조의 자연스러운 변화

## 5. Supabase 테이블 구조 및 데이터 삽입 사양

### 5.1 공개 데모 학급을 위한 스키마 확장

**권장 접근법 1: 학급 플래그 방식**
```sql
-- classes 테이블에 데모 학급 식별 필드 추가
ALTER TABLE classes ADD COLUMN is_demo BOOLEAN DEFAULT FALSE;
ALTER TABLE classes ADD COLUMN is_public BOOLEAN DEFAULT FALSE;

-- 데모 학급 생성 시
INSERT INTO classes (name, user_id, is_demo, is_public) 
VALUES ('샘솔 초등학교 3학년 1반', [시스템_계정_ID], TRUE, TRUE);
```

**권장 접근법 2: 시스템 데모 계정 방식**
```sql
-- 시스템 전용 데모 계정 생성
INSERT INTO auth.users (email, role) 
VALUES ('demo@system.local', 'demo_teacher');

-- 모든 사용자에게 데모 학급 읽기 권한 부여 (RLS 정책)
CREATE POLICY "All users can read demo classes" ON classes
FOR SELECT USING (is_demo = true);
```

### 5.2 테이블 관계도
```
classes (1) ← students (40) ← relations (1,560 × 9개월)
   ↓
surveys (9) ← questions (5 × 9) ← answers (1,800)
```

### 5.3 데이터 삽입 순서
1. **시스템 데모 계정 생성** (필요시)
2. `classes` 테이블에 **공개 데모 학급** 정보 삽입
3. `students` 테이블에 학생 정보 삽입
4. `surveys` 테이블에 월별 설문 정보 삽입
5. `questions` 테이블에 질문 정보 삽입 (설문별 5개씩)
6. 월별 루프:
   - `relations` 테이블에 학생 간 관계 삽입 (1,560개)
   - `answers` 테이블에 주관식 답변 삽입 (200개)

### 5.4 접근 권한 및 보안
- **읽기 권한**: 모든 인증된 사용자가 데모 학급 데이터 조회 가능
- **쓰기 제한**: 데모 학급 데이터는 일반 사용자가 수정/삭제 불가
- **RLS 정책**: Supabase Row Level Security로 권한 관리
- **데이터 보호**: 데모 데이터 무결성 보장을 위한 추가 제약 조건

### 5.5 UUID 생성 및 참조 무결성
- 모든 외래키 관계는 정확히 매칭되어야 함
- UUID는 스크립트 실행 시 동적 생성
- 시스템 데모 계정 ID는 고정값으로 관리하거나 스크립트에서 동적 조회

## 6. 데이터 품질 관리

### 6.1 검증 규칙
- **관계 일관성**: 답변에 언급된 친구 이름이 실제 관계 데이터와 일치
- **성격 일관성**: 학생의 성격 특성이 모든 답변에 일관되게 반영
- **스토리 연속성**: 월별 스토리의 논리적 연결성 확보
- **데이터 완정성**: 누락된 데이터 없이 모든 관계와 답변 생성

### 6.2 품질 확보 방안
- 생성 전 Draft 파일의 스토리라인 검토
- 생성 중 실시간 일관성 검증
- 생성 후 샘플 데이터 수동 검토

## 7. 성공 지표 및 검증 기준

### 7.1 정량적 지표
- **데이터 완성도**: 총 1,560 × 9 = 14,040개 관계 레코드 생성
- **답변 생성률**: 총 1,800개 주관식 답변 생성
- **오류율**: 데이터 삽입 실패율 1% 미만
- **🆕 접근성**: 100% 신규 사용자가 데모 학급에 즉시 접근 가능

### 7.2 정성적 지표
- **현실성**: 실제 초등학교 학급 상황과의 유사성
- **다양성**: 다양한 관계 패턴과 개성있는 답변 포함
- **일관성**: 학생별 성격과 스토리의 논리적 일관성
- **애플리케이션 호환성**: 생성된 데이터로 모든 앱 기능 정상 작동
- **🆕 사용자 경험**: 신규 사용자가 데모를 통해 앱의 가치를 쉽게 이해

## 8. 구현 가이드라인

### 8.1 스크립트 구조
```javascript
// 1. 설정 및 초기화
const STUDENTS = [...]; // Draft 파일에서 가져온 학생 정보
const PERSONALITY_TRAITS = {...}; // 학생별 성격 특성
const MONTHLY_STORIES = {...}; // Draft 파일의 월별 스토리

// 2. 시스템 계정 및 공개 설정
const DEMO_ACCOUNT_ID = await createOrGetDemoAccount();
const CLASS_CONFIG = { is_demo: true, is_public: true };

// 3. 기본 데이터 생성 (학급, 학생, 설문, 질문)
// 4. 월별 루프 (관계 생성, 답변 생성)
// 5. 권한 설정 및 검증
```

### 8.2 핵심 로직
- **관계 생성 함수**: 성격과 스토리를 기반으로 관계 결정
- **답변 생성 함수**: 관계와 성격을 기반으로 자연스러운 답변 생성
- **스토리 적용 함수**: 월별 이벤트를 관계 변화에 반영
- **🆕 권한 설정 함수**: 공개 데모 학급 접근 권한 설정

### 8.3 확장성 고려
- 새로운 학급 데이터 생성 시 재사용 가능한 구조
- 다른 학년이나 다른 설문 형태로 확장 가능
- 성격 특성이나 스토리 패턴의 쉬운 수정
- **🆕 다중 데모 학급**: 향후 여러 예시 학급 지원 가능한 구조

## 9. 공개 데모 학급 운영 가이드

### 9.1 사용자 인터페이스 고려사항
- **데모 표시**: UI에서 "예시 학급" 또는 "데모" 라벨 표시
- **안내 메시지**: 첫 접속 시 데모 학급 사용법 안내
- **기능 제한 안내**: 데모 데이터는 수정할 수 없음을 명시
- **실제 학급 생성 유도**: 데모 체험 후 자신만의 학급 생성 권유

### 9.2 데이터 관리 및 유지보수
- **정기 점검**: 데모 데이터 무결성 주기적 확인
- **복원 기능**: 데모 데이터가 손상된 경우 자동 복원
- **버전 관리**: 데모 데이터 업데이트 시 버전 관리
- **성능 모니터링**: 다수 사용자의 데모 학급 접근 성능 확인

---

**본 PRD는 `EXAMPLE_CLASS_DATA_DRAFT.md`와 함께 읽어야 완전한 이해가 가능합니다. Draft 파일에는 구체적인 학생 정보, 상세한 월별 스토리, 그리고 실제 답변 예시가 포함되어 있어 본 PRD의 추상적 규칙을 구체적으로 구현하는 데 필요한 방향성을 제공합니다.** 