import { createClient } from '@supabase/supabase-js';
import { config } from 'dotenv';
import { fileURLToPath } from 'url';
import { dirname, join } from 'path';

// í˜„ì¬ íŒŒì¼ì˜ ë””ë ‰í† ë¦¬ ê²½ë¡œë¥¼ êµ¬í•˜ê¸°
const __filename = fileURLToPath(import.meta.url);
const __dirname = dirname(__filename);

// í™˜ê²½ ë³€ìˆ˜ ë¡œë“œ (.env.local íŒŒì¼ ì‚¬ìš©)
config({ path: join(__dirname, '..', '.env.local') });

// Supabase í´ë¼ì´ì–¸íŠ¸ ìƒì„± (í™˜ê²½ ë³€ìˆ˜ ì‚¬ìš©)
const supabase = createClient(
  process.env.NEXT_PUBLIC_SUPABASE_URL,
  process.env.SUPABASE_SERVICE_ROLE_KEY
);

const DEMO_CLASS_ID = '62af0001-6d16-4001-86e5-e39531ec35f7';

// ìƒ˜í”Œ ë¶„ì„ ê²°ê³¼ ë°ì´í„°
const sampleOverviewAnalysis = {
  class_id: DEMO_CLASS_ID,
  result_data: JSON.stringify({
    "analysis": "# 3í•™ë…„ 1ë°˜ í•™ê¸‰ ê´€ê³„ ì¢…í•© ë¶„ì„\n\n## ğŸ¯ ë¶„ì„ ê°œìš”\n\nì´ë²ˆ ë¶„ì„ì€ 3í•™ë…„ 1ë°˜ 40ëª…ì˜ í•™ìƒë“¤ì„ ëŒ€ìƒìœ¼ë¡œ í•œ ì¢…í•©ì ì¸ í•™ê¸‰ ê´€ê³„ ë¶„ì„ì…ë‹ˆë‹¤. 9ê°œì˜ ë‹¤ì–‘í•œ ì„¤ë¬¸ì„ í†µí•´ ìˆ˜ì§‘ëœ 1,726ê°œì˜ ì‘ë‹µê³¼ 14,040ê°œì˜ ê´€ê³„ ë°ì´í„°ë¥¼ ë°”íƒ•ìœ¼ë¡œ í•™ê¸‰ ë‚´ ì‚¬íšŒì  ì—­í•™ êµ¬ì¡°ë¥¼ íŒŒì•…í–ˆìŠµë‹ˆë‹¤.\n\n## ğŸ« í•™ê¸‰ ì „ì²´ íŠ¹ì„±\n\n### ê¸ì •ì ì¸ ì¸¡ë©´\n- **ë†’ì€ ì°¸ì—¬ë„**: ì „ì²´ í•™ìƒì˜ 95% ì´ìƒì´ ì„¤ë¬¸ì— ì ê·¹ì ìœ¼ë¡œ ì°¸ì—¬\n- **ë‹¤ì–‘í•œ ê´€ê³„ í˜•ì„±**: í•™ìƒë“¤ì´ í­ë„“ì€ ë˜ë˜ ê´€ê³„ë¥¼ í˜•ì„±í•˜ê³  ìˆìŒ\n- **ê· í˜•ì¡íŒ ì„±ë³„ êµ¬ì„±**: ë‚¨ë…€ í•™ìƒ ê°„ ìì—°ìŠ¤ëŸ¬ìš´ êµë¥˜ê°€ í™œë°œ\n\n### ì£¼ëª©í•  ì \n- **ë¦¬ë”ì‹­ ë¶„ì‚°**: ì—¬ëŸ¬ í•™ìƒì´ ë‹¤ì–‘í•œ ì˜ì—­ì—ì„œ ë¦¬ë”ì‹­ì„ ë°œíœ˜\n- **í¬ìš©ì  ë¶„ìœ„ê¸°**: ëŒ€ë¶€ë¶„ì˜ í•™ìƒì´ í•™ê¸‰ ê³µë™ì²´ì— ì†Œì†ê°ì„ ëŠë¼ê³  ìˆìŒ\n- **ê°ˆë“± ê´€ë¦¬**: ì†Œê·œëª¨ ê°ˆë“±ì´ ìˆì§€ë§Œ ê±´ì„¤ì ìœ¼ë¡œ í•´ê²°ë˜ëŠ” ê²½í–¥\n\n## ğŸ“Š ê´€ê³„ íŒ¨í„´ ë¶„ì„\n\n### í•µì‹¬ ê´€ê³„ë§\n1. **í•™ìŠµ ì¤‘ì‹¬ ê·¸ë£¹**: ê¹€ë¯¼ì¤€, ì´ì„œìœ¤, ë°•ë„í˜„ì„ ì¤‘ì‹¬ìœ¼ë¡œ í•œ í•™ìŠµ ë™ê¸°ê°€ ë†’ì€ ê·¸ë£¹\n2. **ì‚¬êµì  ê·¸ë£¹**: ìµœí•˜ì€, ì •ìš°ì§„, ê°•ì‹œìš°ë¥¼ ì¤‘ì‹¬ìœ¼ë¡œ í•œ í™œë°œí•œ ì†Œí†µ ê·¸ë£¹\n3. **ì˜ˆìˆ /ì°½ì˜ ê·¸ë£¹**: ìœ¤ì„œì•„, ì„ì¬ë¯¼ì„ ì¤‘ì‹¬ìœ¼ë¡œ í•œ ì°½ì˜ì  í™œë™ ì„ í˜¸ ê·¸ë£¹\n\n### íŠ¹ë³„í•œ ê´€ì°°ì‚¬í•­\n- **ë©˜í† -ë©˜í‹° ê´€ê³„**: ìƒê¸‰ìƒ ì—­í• ì„ í•˜ëŠ” í•™ìƒë“¤ì´ ìì—°ìŠ¤ëŸ½ê²Œ ë™ê¸‰ìƒë“¤ì„ ë„ì›€\n- **í¬ë¡œìŠ¤ ê·¸ë£¹ ì—°ê²°**: ì—¬ëŸ¬ ê·¸ë£¹ì„ ì—°ê²°í•˜ëŠ” 'ë¸Œë¦¿ì§€' ì—­í•  í•™ìƒë“¤ ì¡´ì¬\n- **í¬ìš©ì  íƒœë„**: ìƒˆë¡œìš´ í•™ìƒì´ë‚˜ ë‹¤ë¥¸ ì„±í–¥ì˜ í•™ìƒë“¤ì„ ë°›ì•„ë“¤ì´ëŠ” ê°œë°©ì  ë¶„ìœ„ê¸°\n\n## ğŸ¯ êµìœ¡ì  ì‹œì‚¬ì \n\n### ê°•ì  í™œìš© ë°©ì•ˆ\n1. **í˜‘ë ¥ í•™ìŠµ í™œì„±í™”**: ê¸°ì¡´ ê´€ê³„ë§ì„ í™œìš©í•œ ëª¨ë‘  êµ¬ì„±\n2. **ë¦¬ë”ì‹­ ê°œë°œ**: ë‹¤ì–‘í•œ ì˜ì—­ì˜ ë¦¬ë”ë“¤ì—ê²Œ ë” ë§ì€ ê¸°íšŒ ì œê³µ\n3. **ë˜ë˜ êµìœ¡**: í•™ìƒ ê°„ êµìœ¡ íš¨ê³¼ê°€ ë†’ì€ ì˜ì—­ì—ì„œ ë˜ë˜ íŠœí„°ë§ ë„ì…\n\n### ê°œì„  í•„ìš” ì˜ì—­\n1. **ì†Œì™¸ í•™ìƒ ì§€ì›**: ê´€ê³„ë§ì—ì„œ ìƒëŒ€ì ìœ¼ë¡œ ì†Œì™¸ëœ í•™ìƒë“¤ì„ ìœ„í•œ íŠ¹ë³„ ê´€ì‹¬\n2. **ê°ˆë“± ì¤‘ì¬**: ì‘ì€ ê°ˆë“±ë“¤ì´ í™•ëŒ€ë˜ì§€ ì•Šë„ë¡ ì¡°ê¸° ê°œì… ì‹œìŠ¤í…œ êµ¬ì¶•\n3. **ë‹¤ì–‘ì„± ì¡´ì¤‘**: ì„œë¡œ ë‹¤ë¥¸ ì„±í–¥ê³¼ ê´€ì‹¬ì‚¬ë¥¼ ê°€ì§„ í•™ìƒë“¤ ê°„ì˜ ì´í•´ ì¦ì§„\n\n## ğŸ’¡ êµ¬ì²´ì  ê¶Œì¥ì‚¬í•­\n\n### ë‹¨ê¸° ê°œì„  ë°©ì•ˆ (1ê°œì›” ë‚´)\n- ëª¨ë‘  í™œë™ ì‹œ ê´€ê³„ë§ì„ ê³ ë ¤í•œ ì „ëµì  ë°°ì¹˜\n- ë§¤ì£¼ 'ì¹œêµ¬ ì¹­ì°¬í•˜ê¸°' ì‹œê°„ì„ í†µí•œ ê¸ì •ì  ê´€ê³„ ê°•í™”\n- ê°ˆë“± ìƒí™© ë°œìƒ ì‹œ ì¦‰ì‹œ ëŒ€í™”ë¥¼ í†µí•œ í•´ê²° ì‹œë„\n\n### ì¤‘ê¸° ê°œì„  ë°©ì•ˆ (3ê°œì›” ë‚´)\n- í•™ê¸‰ ë‚´ ë‹¤ì–‘í•œ ì—­í•  ë¶„ë‹´ì„ í†µí•œ ì±…ì„ê° ì¦ì§„\n- ë˜ë˜ ë©˜í† ë§ ì‹œìŠ¤í…œ ë„ì…ìœ¼ë¡œ í•™ìŠµ íš¨ê³¼ ë° ê´€ê³„ ê°œì„ \n- ì •ê¸°ì ì¸ í•™ê¸‰ íšŒì˜ë¥¼ í†µí•œ ë¯¼ì£¼ì  ì˜ì‚¬ê²°ì • ê²½í—˜\n\n### ì¥ê¸° ê°œì„  ë°©ì•ˆ (í•™ê¸° ë‹¨ìœ„)\n- í•™ê¸‰ ì „ì²´ì˜ ì†Œì†ê° ê°•í™”ë¥¼ ìœ„í•œ ê³µë™ í”„ë¡œì íŠ¸ ìˆ˜í–‰\n- ê°œë³„ í•™ìƒì˜ íŠ¹ì„±ì„ ê³ ë ¤í•œ ë§ì¶¤í˜• ì§€ë„ ë°©ì•ˆ ìˆ˜ë¦½\n- í•™ë¶€ëª¨ì™€ì˜ ì—°ê³„ë¥¼ í†µí•œ ê°€ì •-í•™êµ í˜‘ë ¥ ì²´ê³„ êµ¬ì¶•\n\n## ğŸŠ ê²°ë¡ \n\n3í•™ë…„ 1ë°˜ì€ ì „ë°˜ì ìœ¼ë¡œ ê±´ê°•í•˜ê³  í™œë ¥ ë„˜ì¹˜ëŠ” í•™ê¸‰ ê³µë™ì²´ë¥¼ í˜•ì„±í•˜ê³  ìˆìŠµë‹ˆë‹¤. í•™ìƒë“¤ ê°„ì˜ ìì—°ìŠ¤ëŸ¬ìš´ ìœ ëŒ€ê°ê³¼ ì„œë¡œë¥¼ ì¡´ì¤‘í•˜ëŠ” ë¶„ìœ„ê¸°ê°€ ì´ í•™ê¸‰ì˜ ê°€ì¥ í° ê°•ì ì…ë‹ˆë‹¤. í–¥í›„ ì´ëŸ¬í•œ ê¸ì •ì  ë¶„ìœ„ê¸°ë¥¼ ë”ìš± ë°œì „ì‹œí‚¤ë©´ì„œ, ê°œë³„ í•™ìƒë“¤ì˜ ë‹¤ì–‘í•œ íŠ¹ì„±ì„ ë”ìš± ì¡´ì¤‘í•˜ê³  í¬ìš©í•˜ëŠ” ë°©í–¥ìœ¼ë¡œ ë‚˜ì•„ê°„ë‹¤ë©´ ëª¨ë“  í•™ìƒì´ í–‰ë³µí•˜ê²Œ ì„±ì¥í•  ìˆ˜ ìˆëŠ” ì´ìƒì ì¸ í•™ìŠµ í™˜ê²½ì´ ë  ê²ƒì…ë‹ˆë‹¤."
  }),
  summary: '3í•™ë…„ 1ë°˜ì˜ ì¢…í•©ì ì¸ í•™ê¸‰ ê´€ê³„ ë¶„ì„ ê²°ê³¼ì…ë‹ˆë‹¤. 40ëª… í•™ìƒë“¤ì˜ ê¸ì •ì ì¸ ê´€ê³„ í˜•ì„±ê³¼ ê°œì„  ë°©ì•ˆì„ ì œì‹œí•©ë‹ˆë‹¤.',
  type: 'overview',
  session_id: 'demo-session-1'
};

const sampleStudentAnalysis1 = {
  class_id: DEMO_CLASS_ID,
  result_data: JSON.stringify({
    "analysis": "# í•™ìŠµ ì¤‘ì‹¬ ê·¸ë£¹ ë¶„ì„ (1/8)\n\n## ğŸ‘¥ ê·¸ë£¹ êµ¬ì„±ì›\n- **ê¹€ë¯¼ì¤€** (ê·¸ë£¹ ë¦¬ë”)\n- **ì´ì„œìœ¤** (í•™ìŠµ ë„ìš°ë¯¸)\n- **ë°•ë„í˜„** (í† ë¡  ë¦¬ë”)\n- **ì¡°ì˜ˆì€** (ì •ë¦¬ ë‹´ë‹¹)\n- **ì‹ ìš°ì„±** (ë°œí‘œ ë‹´ë‹¹)\n\n## ğŸ¯ ê·¸ë£¹ íŠ¹ì„±\n\n### ì£¼ìš” ê°•ì \n- **ë†’ì€ í•™ìŠµ ë™ê¸°**: ëª¨ë“  êµ¬ì„±ì›ì´ í•™ìŠµì— ëŒ€í•œ ê°•í•œ ì˜ìš•ì„ ë³´ì„\n- **í˜‘ë ¥ì  íƒœë„**: ì„œë¡œì˜ ë¶€ì¡±í•œ ë¶€ë¶„ì„ ìì—°ìŠ¤ëŸ½ê²Œ ë³´ì™„\n- **ë¦¬ë”ì‹­ ê³µìœ **: ìƒí™©ì— ë”°ë¼ ë¦¬ë” ì—­í• ì„ ë²ˆê°ˆì•„ ë‹´ë‹¹\n\n### ê´€ê³„ ì—­í•™\n- **ê¹€ë¯¼ì¤€**: ìì—°ìŠ¤ëŸ¬ìš´ ë¦¬ë”ë¡œ ì¸ì •ë°›ìœ¼ë©°, ë‹¤ë¥¸ í•™ìƒë“¤ì˜ ì˜ê²¬ì„ ì˜ ìˆ˜ë ´\n- **ì´ì„œìœ¤**: ì„¸ì‹¬í•œ ì„±ê²©ìœ¼ë¡œ ì–´ë ¤ì›Œí•˜ëŠ” ì¹œêµ¬ë“¤ì„ ì ê·¹ì ìœ¼ë¡œ ë„ì›€\n- **ë°•ë„í˜„**: ë…¼ë¦¬ì  ì‚¬ê³ ë ¥ì´ ë›°ì–´ë‚˜ í† ë¡  ì‹œ ì¤‘ìš”í•œ ì—­í• \n- **ì¡°ì˜ˆì€**: ì²´ê³„ì ì¸ ì„±ê²©ìœ¼ë¡œ ê·¸ë£¹ í™œë™ì˜ ì •ë¦¬ì™€ ë§ˆë¬´ë¦¬ ë‹´ë‹¹\n- **ì‹ ìš°ì„±**: í‘œí˜„ë ¥ì´ ì¢‹ì•„ ê·¸ë£¹ì˜ ì˜ê²¬ì„ ëŒ€í‘œí•˜ì—¬ ë°œí‘œ\n\n## ğŸ“ˆ í•™ìŠµ íš¨ê³¼\n\n### ê¸ì •ì  ì˜í–¥\n1. **ìƒí˜¸ êµìœ¡**: ì„œë¡œ ê°€ë¥´ì¹˜ê³  ë°°ìš°ëŠ” ê³¼ì •ì—ì„œ í•™ìŠµ íš¨ê³¼ ê·¹ëŒ€í™”\n2. **ë™ê¸° ë¶€ì—¬**: ê·¸ë£¹ ë‚´ ê²½ìŸê³¼ í˜‘ë ¥ì´ ê· í˜•ìˆê²Œ ì‘ìš©\n3. **ë¬¸ì œ í•´ê²°**: ë‹¤ì–‘í•œ ê´€ì ì—ì„œ ë¬¸ì œë¥¼ ì ‘ê·¼í•˜ì—¬ ì°½ì˜ì  í•´ê²°ì±… ë„ì¶œ\n\n### ì£¼ì˜ ì‚¬í•­\n- **ê³¼ë„í•œ ì™„ë²½ì£¼ì˜**: ë•Œë¡œ ë„ˆë¬´ ë†’ì€ ê¸°ì¤€ìœ¼ë¡œ ì¸í•œ ìŠ¤íŠ¸ë ˆìŠ¤\n- **ë‹¤ë¥¸ ê·¸ë£¹ê³¼ì˜ ê±°ë¦¬**: í•™ìŠµ ì¤‘ì‹¬ì  ì„±í–¥ìœ¼ë¡œ ì¸í•œ ì‚¬êµì  ê´€ê³„ ë¶€ì¡±\n\n## ğŸ’¡ êµìœ¡ì  í™œìš© ë°©ì•ˆ\n\n### ì¶”ì²œ í™œë™\n1. **ë˜ë˜ êµìœ¡ í”„ë¡œê·¸ë¨**: ë‹¤ë¥¸ í•™ìƒë“¤ì„ ê°€ë¥´ì¹˜ëŠ” ê¸°íšŒ ì œê³µ\n2. **ì‹¬í™” í•™ìŠµ í”„ë¡œì íŠ¸**: ë„ì „ì ì¸ ê³¼ì œë¥¼ í†µí•œ ì—­ëŸ‰ ê°•í™”\n3. **ë¦¬ë”ì‹­ ê°œë°œ**: í•™ê¸‰ ì „ì²´ë¥¼ ì´ë„ëŠ” ê²½í—˜ ê¸°íšŒ í™•ëŒ€\n\n### ê°œì„  ë°©í–¥\n1. **ì‚¬íšŒì  ê´€ê³„ í™•ëŒ€**: ë‹¤ë¥¸ ì„±í–¥ì˜ í•™ìƒë“¤ê³¼ êµë¥˜ ê¸°íšŒ ì¦ì§„\n2. **ìŠ¤íŠ¸ë ˆìŠ¤ ê´€ë¦¬**: ì™„ë²½ì£¼ì˜ ì„±í–¥ ì¡°ì ˆì„ ìœ„í•œ ì§€ë„\n3. **ë‹¤ì–‘ì„± ìˆ˜ìš©**: ë‹¤ë¥¸ í•™ìŠµ ìŠ¤íƒ€ì¼ì„ ê°€ì§„ í•™ìƒë“¤ê³¼ì˜ í˜‘ë ¥ ê²½í—˜\n\n## ğŸŠ ì¢…í•© í‰ê°€\n\nì´ ê·¸ë£¹ì€ í•™ê¸‰ì˜ í•™ìŠµ ë¶„ìœ„ê¸° ì¡°ì„±ì— ë§¤ìš° ê¸ì •ì ì¸ ì—­í• ì„ í•˜ê³  ìˆìŠµë‹ˆë‹¤. ì•ìœ¼ë¡œ ì´ë“¤ì˜ í•™ìŠµ ì—´ì •ì„ ì „ì²´ í•™ê¸‰ìœ¼ë¡œ í™•ì‚°ì‹œí‚¤ë©´ì„œ, ë™ì‹œì— ì‚¬íšŒì  ê´€ê³„ì˜ í­ì„ ë„“í˜€ë‚˜ê°€ëŠ” ê²ƒì´ ì¤‘ìš”í•©ë‹ˆë‹¤."
  }),
  summary: 'í•™ìŠµ ì¤‘ì‹¬ ê·¸ë£¹ì˜ ê´€ê³„ ë¶„ì„ì…ë‹ˆë‹¤. ê¹€ë¯¼ì¤€, ì´ì„œìœ¤, ë°•ë„í˜„ ë“± 5ëª…ì˜ í•™ìŠµ ë™ê¸°ê°€ ë†’ì€ í•™ìƒë“¤ì˜ í˜‘ë ¥ ê´€ê³„ë¥¼ ë¶„ì„í–ˆìŠµë‹ˆë‹¤.',
  type: 'students-1',
  session_id: 'demo-session-1'
};

const sampleStudentAnalysis2 = {
  class_id: DEMO_CLASS_ID,
  result_data: JSON.stringify({
    "analysis": "# ì‚¬êµì  ê·¸ë£¹ ë¶„ì„ (2/8)\n\n## ğŸ‘¥ ê·¸ë£¹ êµ¬ì„±ì›\n- **ìµœí•˜ì€** (ê·¸ë£¹ ì¤‘ì‹¬)\n- **ì •ìš°ì§„** (ë¶„ìœ„ê¸° ë©”ì´ì»¤)\n- **ê°•ì‹œìš°** (ì†Œí†µ ë¦¬ë”)\n- **í•œë³„ì´** (ê³µê° ë¦¬ë”)\n- **ì˜¤ì„œí˜„** (í™œë™ ê¸°íšì)\n\n## ğŸ¯ ê·¸ë£¹ íŠ¹ì„±\n\n### ì£¼ìš” ê°•ì \n- **ë›°ì–´ë‚œ ì†Œí†µ ëŠ¥ë ¥**: ëª¨ë“  êµ¬ì„±ì›ì´ ì›í™œí•œ ëŒ€í™” ëŠ¥ë ¥ì„ ë³´ìœ \n- **í¬ìš©ì  ë¶„ìœ„ê¸°**: ìƒˆë¡œìš´ ì¹œêµ¬ë“¤ì„ ìì—°ìŠ¤ëŸ½ê²Œ ë°›ì•„ë“¤ì„\n- **ê¸ì •ì  ì—ë„ˆì§€**: í•­ìƒ ë°ê³  í™œê¸°ì°¬ ë¶„ìœ„ê¸° ì¡°ì„±\n\n### ê´€ê³„ ì—­í•™\n- **ìµœí•˜ì€**: ìì—°ìŠ¤ëŸ¬ìš´ ê´€ê³„ ì¡°ì •ì ì—­í• , ê°ˆë“± ìƒí™©ì—ì„œ ì¤‘ì¬ ëŠ¥ë ¥ íƒì›”\n- **ì •ìš°ì§„**: ìœ ë¨¸ ê°ê°ì´ ë›°ì–´ë‚˜ ì–´ìƒ‰í•œ ìƒí™©ì„ ìì—°ìŠ¤ëŸ½ê²Œ í•´ê²°\n- **ê°•ì‹œìš°**: ê²½ì²­ ëŠ¥ë ¥ì´ ì¢‹ì•„ ì¹œêµ¬ë“¤ì˜ ê³ ë¯¼ ìƒë‹´ ì—­í• \n- **í•œë³„ì´**: ê°ì •ì  ì§€ì§€ë¥¼ ì œê³µí•˜ëŠ” ê·¸ë£¹ì˜ ì •ì„œì  ì•ˆì •ì\n- **ì˜¤ì„œí˜„**: ì°½ì˜ì ì¸ ì•„ì´ë””ì–´ë¡œ ì¬ë¯¸ìˆëŠ” í™œë™ì„ ê¸°íš\n\n## ğŸ“ˆ ì‚¬íšŒì  ì˜í–¥\n\n### ê¸ì •ì  íš¨ê³¼\n1. **í•™ê¸‰ ë¶„ìœ„ê¸° ê°œì„ **: ì „ì²´ í•™ê¸‰ì˜ í™”í•©ê³¼ í™œë ¥ ì¦ì§„ì— ê¸°ì—¬\n2. **ê°ˆë“± ì™„í™”**: ë‹¤ë¥¸ í•™ìƒë“¤ ê°„ì˜ ê°ˆë“± ìƒí™©ì—ì„œ ìì—°ìŠ¤ëŸ¬ìš´ ì¤‘ì¬ ì—­í• \n3. **í¬ìš© ë¬¸í™”**: ì†Œì™¸ë  ìˆ˜ ìˆëŠ” í•™ìƒë“¤ì„ ì ê·¹ì ìœ¼ë¡œ í¬í•¨ì‹œí‚´\n\n### ì£¼ì˜ ì‚¬í•­\n- **í•™ìŠµ ì§‘ì¤‘ë„**: ë•Œë¡œ ì‚¬êµ í™œë™ì´ í•™ìŠµì— ë°©í•´ê°€ ë  ìˆ˜ ìˆìŒ\n- **ì†ŒìŒ ë¬¸ì œ**: í™œë°œí•œ ëŒ€í™”ë¡œ ì¸í•œ êµì‹¤ ë‚´ ì†ŒìŒ ë°œìƒ\n\n## ğŸ’¡ êµìœ¡ì  í™œìš© ë°©ì•ˆ\n\n### ì¶”ì²œ í™œë™\n1. **ë˜ë˜ ì¤‘ì¬ í”„ë¡œê·¸ë¨**: ê°ˆë“± í•´ê²° ëŠ¥ë ¥ì„ í™œìš©í•œ ë˜ë˜ ìƒë‹´ì‚¬ ì—­í• \n2. **í•™ê¸‰ í–‰ì‚¬ ê¸°íš**: ì°½ì˜ì  ê¸°íš ëŠ¥ë ¥ì„ í™œìš©í•œ í–‰ì‚¬ ì¤€ë¹„ ìœ„ì›íšŒ\n3. **ì‹ ì…ìƒ ë„ìš°ë¯¸**: ì „í•™ìƒì´ë‚˜ ìƒˆë¡œìš´ ì¹œêµ¬ë“¤ì˜ ì ì‘ ë„ì›€\n\n### ê°œì„  ë°©í–¥\n1. **í•™ìŠµ ìŠµê´€ ê°œì„ **: ì‚¬êµì„±ê³¼ í•™ìŠµì˜ ê· í˜• ì¡íŒ ë°œì „\n2. **ë¦¬ë”ì‹­ ê°œë°œ**: ê¸ì •ì  ì˜í–¥ë ¥ì„ ë” ì²´ê³„ì ìœ¼ë¡œ ë°œíœ˜í•  ìˆ˜ ìˆëŠ” ê¸°íšŒ ì œê³µ\n3. **ì±…ì„ê° ê°•í™”**: ì¦ê±°ìš´ í™œë™ê³¼ í•¨ê»˜ ì±…ì„ê°ë„ ê¸°ë¥¼ ìˆ˜ ìˆëŠ” ì—­í•  ë¶€ì—¬\n\n## ğŸŠ ì¢…í•© í‰ê°€\n\nì´ ê·¸ë£¹ì€ í•™ê¸‰ì˜ ì‚¬íšŒì  ì‘ì§‘ë ¥ê³¼ ì •ì„œì  ì•ˆì •ê° í˜•ì„±ì— í•µì‹¬ì ì¸ ì—­í• ì„ í•˜ê³  ìˆìŠµë‹ˆë‹¤. ì´ë“¤ì˜ ì‚¬êµì  ëŠ¥ë ¥ê³¼ í¬ìš©ë ¥ì„ ë”ìš± ë°œì „ì‹œì¼œ í•™ê¸‰ ì „ì²´ì˜ í™”í•©ì„ ì´ëŒì–´ê°€ëŠ” ê²ƒì´ ì¤‘ìš”í•©ë‹ˆë‹¤."
  }),
  summary: 'ì‚¬êµì  ê·¸ë£¹ì˜ ê´€ê³„ ë¶„ì„ì…ë‹ˆë‹¤. ìµœí•˜ì€, ì •ìš°ì§„, ê°•ì‹œìš° ë“± 5ëª…ì˜ ì†Œí†µ ëŠ¥ë ¥ì´ ë›°ì–´ë‚œ í•™ìƒë“¤ì˜ ì‚¬íšŒì  ì—­í• ì„ ë¶„ì„í–ˆìŠµë‹ˆë‹¤.',
  type: 'students-2',
  session_id: 'demo-session-1'
};

// ìƒí™œê¸°ë¡ë¶€ ìƒ˜í”Œ ë°ì´í„°
const sampleSchoolRecord = {
  class_id: DEMO_CLASS_ID,
  result_data: JSON.stringify({
    "records": {
      "ê¹€ë¯¼ì¤€": {
        "êµê³¼í•™ìŠµë°œë‹¬ìƒí™©": "ìˆ˜í•™ì  ì‚¬ê³ ë ¥ì´ ë›°ì–´ë‚˜ë©°, ë¬¸ì œ í•´ê²° ê³¼ì •ì—ì„œ ë…¼ë¦¬ì ì´ê³  ì²´ê³„ì ì¸ ì ‘ê·¼ì„ ë³´ì…ë‹ˆë‹¤. íŠ¹íˆ ë³µì¡í•œ ì‘ìš© ë¬¸ì œì—ì„œë„ í¬ê¸°í•˜ì§€ ì•Šê³  ëê¹Œì§€ í•´ê²°í•˜ë ¤ëŠ” ì˜ì§€ê°€ ê°•í•©ë‹ˆë‹¤.",
        "í–‰ë™íŠ¹ì„±ë°ì¢…í•©ì˜ê²¬": "í•™ê¸‰ì˜ ìì—°ìŠ¤ëŸ¬ìš´ ë¦¬ë”ë¡œì„œ ì¹œêµ¬ë“¤ì˜ ì˜ê²¬ì„ ìˆ˜ë ´í•˜ê³  ì¡°ìœ¨í•˜ëŠ” ëŠ¥ë ¥ì´ ë›°ì–´ë‚©ë‹ˆë‹¤. ë˜ë˜ ì¹œêµ¬ë“¤ì„ ë„ì™€ì£¼ëŠ” ê²ƒì„ ì¢‹ì•„í•˜ë©°, ì±…ì„ê° ìˆê²Œ ë§¡ì€ ì¼ì„ ì™„ìˆ˜í•©ë‹ˆë‹¤."
      },
      "ì´ì„œìœ¤": {
        "êµê³¼í•™ìŠµë°œë‹¬ìƒí™©": "êµ­ì–´ í‘œí˜„ë ¥ì´ ìš°ìˆ˜í•˜ë©°, ë…ì„œë¥¼ í†µí•´ ë‹¤ì–‘í•œ ì§€ì‹ì„ ìŠµë“í•˜ê³  ì´ë¥¼ ë§ê³¼ ê¸€ë¡œ íš¨ê³¼ì ìœ¼ë¡œ í‘œí˜„í•©ë‹ˆë‹¤. ì°½ì˜ì ì¸ ê¸€ì“°ê¸° í™œë™ì—ì„œ ë…ì°½ì ì¸ ì•„ì´ë””ì–´ë¥¼ ë³´ì—¬ì¤ë‹ˆë‹¤.",
        "í–‰ë™íŠ¹ì„±ë°ì¢…í•©ì˜ê²¬": "ì„¸ì‹¬í•˜ê³  ë°°ë ¤ì‹¬ì´ ê¹Šì–´ ì–´ë ¤ì›€ì„ ê²ªëŠ” ì¹œêµ¬ë“¤ì„ ì ê·¹ì ìœ¼ë¡œ ë„ì™€ì¤ë‹ˆë‹¤. í•™ê¸‰ ë‚´ì—ì„œ ê°ˆë“±ì´ ìƒê²¼ì„ ë•Œ ê°ê´€ì ì´ê³  ê³µì •í•œ ê´€ì ì—ì„œ í•´ê²°ì±…ì„ ì œì‹œí•©ë‹ˆë‹¤."
      },
      "ìµœí•˜ì€": {
        "êµê³¼í•™ìŠµë°œë‹¬ìƒí™©": "ì˜ˆìˆ  ë¶„ì•¼ì— ë›°ì–´ë‚œ ì¬ëŠ¥ì„ ë³´ì´ë©°, íŠ¹íˆ ë¯¸ìˆ  ì‹œê°„ì— ì°½ì˜ì ì´ê³  ì•„ë¦„ë‹¤ìš´ ì‘í’ˆì„ ë§Œë“¤ì–´ëƒ…ë‹ˆë‹¤. ìƒ‰ê°ê³¼ êµ¬ì„±ì— ëŒ€í•œ ê°ê°ì´ íƒì›”í•©ë‹ˆë‹¤.",
        "í–‰ë™íŠ¹ì„±ë°ì¢…í•©ì˜ê²¬": "ë°ê³  ê¸ì •ì ì¸ ì„±ê²©ìœ¼ë¡œ í•™ê¸‰ ë¶„ìœ„ê¸°ë¥¼ í™œê¸°ì°¨ê²Œ ë§Œë“œëŠ” ë° ê¸°ì—¬í•©ë‹ˆë‹¤. ì¹œêµ¬ë“¤ê³¼ì˜ ê´€ê³„ì—ì„œ í¬ìš©ë ¥ì´ ë›°ì–´ë‚˜ë©°, ìƒˆë¡œìš´ ì¹œêµ¬ë“¤ì„ ìì—°ìŠ¤ëŸ½ê²Œ ë°›ì•„ë“¤ì…ë‹ˆë‹¤."
      },
      "ì •ìš°ì§„": {
        "êµê³¼í•™ìŠµë°œë‹¬ìƒí™©": "ì²´ìœ¡ í™œë™ì—ì„œ ë›°ì–´ë‚œ ìš´ë™ëŠ¥ë ¥ì„ ë³´ì´ë©°, íŒ€ í™œë™ì—ì„œ í˜‘ë ¥ê³¼ ë¦¬ë”ì‹­ì„ ë°œíœ˜í•©ë‹ˆë‹¤. ìŠ¹ë¶€ìš•ì´ ì ì ˆí•˜ì—¬ ê³µì •í•œ ê²½ìŸì„ ì¶”êµ¬í•©ë‹ˆë‹¤.",
        "í–‰ë™íŠ¹ì„±ë°ì¢…í•©ì˜ê²¬": "ìœ ë¨¸ ê°ê°ì´ ë›°ì–´ë‚˜ ì–´ìƒ‰í•˜ê±°ë‚˜ ê¸´ì¥ëœ ìƒí™©ì„ ìì—°ìŠ¤ëŸ½ê²Œ í•´ê²°í•˜ëŠ” ëŠ¥ë ¥ì´ ìˆìŠµë‹ˆë‹¤. ì¹œêµ¬ë“¤ê³¼ì˜ ê´€ê³„ì—ì„œ ì‹ ë¢°ë¥¼ ë°”íƒ•ìœ¼ë¡œ í•œ ê¹Šì€ ìš°ì •ì„ ìœ ì§€í•©ë‹ˆë‹¤."
      },
      "ë°•ë„í˜„": {
        "êµê³¼í•™ìŠµë°œë‹¬ìƒí™©": "ê³¼í•™ì  íƒêµ¬ë ¥ì´ ë›°ì–´ë‚˜ë©°, ì‹¤í—˜ í™œë™ì—ì„œ ì ê·¹ì ì´ê³  ì •í™•í•œ ê´€ì°°ë ¥ì„ ë³´ì…ë‹ˆë‹¤. ê°€ì„¤ ì„¤ì •ê³¼ ê²€ì¦ ê³¼ì •ì—ì„œ ë…¼ë¦¬ì  ì‚¬ê³ ë¥¼ ì˜ í™œìš©í•©ë‹ˆë‹¤.",
        "í–‰ë™íŠ¹ì„±ë°ì¢…í•©ì˜ê²¬": "ì§„ì§€í•˜ê³  ì„±ì‹¤í•œ íƒœë„ë¡œ í•™ê¸‰ í™œë™ì— ì°¸ì—¬í•©ë‹ˆë‹¤. í† ë¡ ì´ë‚˜ ë°œí‘œ í™œë™ì—ì„œ ìì‹ ì˜ ì˜ê²¬ì„ ë…¼ë¦¬ì ìœ¼ë¡œ ì œì‹œí•˜ë©°, ë‹¤ë¥¸ ì‚¬ëŒì˜ ì˜ê²¬ë„ ê²½ì²­í•©ë‹ˆë‹¤."
      }
    }
  }),
  summary: '3í•™ë…„ 1ë°˜ ì£¼ìš” í•™ìƒë“¤ì˜ ìƒí™œê¸°ë¡ë¶€ ì˜ˆì‹œì…ë‹ˆë‹¤.'
};

/**
 * ë°ëª¨ ë¶„ì„ ê²°ê³¼ ì‚½ì…
 */
async function insertDemoAnalysis() {
  console.log('ğŸ¯ ë°ëª¨ í•™ê¸‰ì— ë¶„ì„ ê²°ê³¼ ì‚½ì… ì¤‘...\n');

  try {
    // 1. ê¸°ì¡´ ë¶„ì„ ê²°ê³¼ í™•ì¸
    const { data: existingAnalysis } = await supabase
      .from('analysis_results')
      .select('id, type')
      .eq('class_id', DEMO_CLASS_ID);

    console.log(`ğŸ“Š ê¸°ì¡´ ë¶„ì„ ê²°ê³¼: ${existingAnalysis?.length || 0}ê°œ`);

    // 2. ê¸°ì¡´ ë°ì´í„° ì‚­ì œ (ì˜µì…˜)
    if (existingAnalysis && existingAnalysis.length > 0) {
      console.log('ğŸ—‘ï¸ ê¸°ì¡´ ë¶„ì„ ê²°ê³¼ ì‚­ì œ ì¤‘...');
      const { error: deleteError } = await supabase
        .from('analysis_results')
        .delete()
        .eq('class_id', DEMO_CLASS_ID);

      if (deleteError) {
        console.error('âŒ ê¸°ì¡´ ë°ì´í„° ì‚­ì œ ì‹¤íŒ¨:', deleteError);
      } else {
        console.log('âœ… ê¸°ì¡´ ë¶„ì„ ê²°ê³¼ ì‚­ì œ ì™„ë£Œ');
      }
    }

    // 3. ìƒˆ ë¶„ì„ ê²°ê³¼ ì‚½ì…
    console.log('ğŸ“ ìƒˆ ë¶„ì„ ê²°ê³¼ ì‚½ì… ì¤‘...');
    
    const analysisData = [
      sampleOverviewAnalysis,
      sampleStudentAnalysis1,
      sampleStudentAnalysis2
    ];

    const { data: insertedAnalysis, error: insertError } = await supabase
      .from('analysis_results')
      .insert(analysisData)
      .select();

    if (insertError) {
      console.error('âŒ ë¶„ì„ ê²°ê³¼ ì‚½ì… ì‹¤íŒ¨:', insertError);
      return;
    }

    console.log(`âœ… ${insertedAnalysis.length}ê°œì˜ ë¶„ì„ ê²°ê³¼ ì‚½ì… ì™„ë£Œ`);

    // 4. ìƒí™œê¸°ë¡ë¶€ ì²˜ë¦¬
    const { data: existingRecords } = await supabase
      .from('school_records')
      .select('id')
      .eq('class_id', DEMO_CLASS_ID);

    console.log(`ğŸ“Š ê¸°ì¡´ ìƒí™œê¸°ë¡ë¶€: ${existingRecords?.length || 0}ê°œ`);

    // ê¸°ì¡´ ìƒí™œê¸°ë¡ë¶€ ì‚­ì œ
    if (existingRecords && existingRecords.length > 0) {
      console.log('ğŸ—‘ï¸ ê¸°ì¡´ ìƒí™œê¸°ë¡ë¶€ ì‚­ì œ ì¤‘...');
      const { error: deleteRecordError } = await supabase
        .from('school_records')
        .delete()
        .eq('class_id', DEMO_CLASS_ID);

      if (deleteRecordError) {
        console.error('âŒ ê¸°ì¡´ ìƒí™œê¸°ë¡ë¶€ ì‚­ì œ ì‹¤íŒ¨:', deleteRecordError);
      } else {
        console.log('âœ… ê¸°ì¡´ ìƒí™œê¸°ë¡ë¶€ ì‚­ì œ ì™„ë£Œ');
      }
    }

    // ìƒˆ ìƒí™œê¸°ë¡ë¶€ ì‚½ì…
    console.log('ğŸ“ ìƒˆ ìƒí™œê¸°ë¡ë¶€ ì‚½ì… ì¤‘...');
    const { data: insertedRecord, error: recordError } = await supabase
      .from('school_records')
      .insert([sampleSchoolRecord])
      .select();

    if (recordError) {
      console.error('âŒ ìƒí™œê¸°ë¡ë¶€ ì‚½ì… ì‹¤íŒ¨:', recordError);
    } else {
      console.log('âœ… ìƒí™œê¸°ë¡ë¶€ ì‚½ì… ì™„ë£Œ');
    }

    console.log('\nğŸ‰ ë°ëª¨ ë°ì´í„° ì‚½ì… ì™„ë£Œ!');
    console.log('ğŸ“‹ ì‚½ì…ëœ ë°ì´í„°:');
    console.log(`   - ì¢…í•© ë¶„ì„: 1ê°œ`);
    console.log(`   - í•™ìƒ ê·¸ë£¹ ë¶„ì„: 2ê°œ`);
    console.log(`   - ìƒí™œê¸°ë¡ë¶€: 1ê°œ`);

  } catch (error) {
    console.error('âŒ ì „ì²´ ê³¼ì • ì‹¤íŒ¨:', error);
  }
}

// ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰
insertDemoAnalysis(); 